function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var o,r=Object.keys(t);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(t),e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(o),!0).forEach(function(e){_defineProperty(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function _defineProperty(e,t,o){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0===o)return("string"===t?String:Number)(e);o=o.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var o;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(o="Object"===(o={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:o)||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=Array(t);o<t;o++)r[o]=e[o];return r}function getPositionAvailable(e,t,o){["up","down"].includes(o)?e.positionsY=intersection(e,t,e.curvesDefaults,e.lineY,2):e.positionsX=intersection(e,t,e.curvesDefaults,e.lineX)}function move(e,t,o,r){if(e.pointTarget&&e.pointer){createLineIntersection(e,t),getPositionAvailable(e,t,r);var n=e.positions.at(-2),i=["up","down"].includes(r)?e.positionsY:e.positionsX,l=["left","right"].includes(r)?e.targeIndex:e.targeIndexY,o=(e.inBorder&&["ejeX","ejeY"].includes(null==o||null==(o=o.at(-2))?void 0:o.typeCurve)&&(e.inBorder=!1),["up","right"].includes(r)?l++:l--,null==i?void 0:i[l]);if(null!=e&&e.inBorder||"border"!=(null==o?void 0:o.typeCurve)){if(-1==l||e.inBorder&&.1<gDist([o.x,o.y],n))return void console.log("return");e.inBorder=!1}else e.inBorder=!0;n=[o.x,o.y];e.pointer.setPositionDirectly(JXG.COORDS_BY_USER,n),savePosition(e,t,e.pointer,i[l].typeCurve),e.lastDirection=r}}function intersection(r,n,i,l){for(var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,s=[],u=0;u<i.length;u++)if(!i[u].useIntersection&&null!==i[u].useIntersection&&"finishCurve"!==i[u].typeCurve)for(var c=0;c<3;c++)!function(){var e;try{t=JXG.Math.Geometry.meetCurveLine(i[u],l,c,n,!0)}catch(e){}if(!t)return;var t,o=null==(e=t)||null==(e=e.usrCoords)?void 0:e.slice(1);Number.isNaN(null==(e=t)||null==(e=e.usrCoords)?void 0:e.slice(1)[0])||!(1!=a&&gInterPoint(r.pointer.X(),o[0])||1==a&&gInterPoint(r.pointer.Y(),o[1]))||!o[0]&&0!=o[0]||!o[1]&&0!=o[1]||s.some(function(e){return gDist(o,[e.x,e.y])<.01&&!(gDist(o,r.pointer)<.01)})||gDist(o,r.pointer)<.01||(t={x:o[0],y:o[1],typeCurve:i[u].typeCurve},s.push(t))}();var e=r.pointer.coords.usrCoords.slice(1);return s.push({x:e[0],y:e[1],id:r.pointer.id}),s.sort(function(e,t){return 1==a?e.x-t.x:e.y-t.y}),1==a?r.targeIndex=s.findIndex(function(e){return e.id===r.pointer.id}):r.targeIndexY=s.findIndex(function(e){return e.id===r.pointer.id}),s}function finishPoint(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,o=t.board,r=t.def,t=(t.clone.querySelector(".rSelectRoad"),r.positions[0].visProp.fillcolor);addFinish(e),r.statusValidate=!1,r.selectRoad.resetColor(),r.positions=cleanRoad({def:r,road:r.positions}),r.memory.push({element:_toConsumableArray(r.positions.slice(1)),from:r.roadData[r.positions[0].iMod]}),drawingRoad(r,o),r.roadData[r.positions[0].iMod].push(_toConsumableArray(r.positions)),r.other.push(r.roadDrawng),r.positions=[],r.roadDrawng.setAttribute({layer:null,strokeColor:t}),r.roadDrawng=null,r.pointTarget=null}function cleanRoad(e){var r=e.def,n=e.road;return n.filter(function(t,e){var o;return t.setAttribute({size:function(){var e;return r.pointTarget&&(null==(e=r.pointTarget)?void 0:e.iMod)==t.iMod?4:2},visible:!1}),0==e||e==n.length-1||!(gInterPoint(null==t?void 0:t.Y(),null==n||null==(o=n[e-1])?void 0:o.Y(),.01)&&!gInterPoint(null==t?void 0:t.X(),null==n||null==(o=n[e+1])?void 0:o.X(),.01)||!gInterPoint(null==t?void 0:t.Y(),null==n||null==(o=n[e-1])?void 0:o.Y(),.01)&&gInterPoint(null==t?void 0:t.X(),null==n||null==(o=n[e+1])?void 0:o.X(),.01))}).map(function(t){return t.setAttribute({size:function(){var e;return r.pointTarget&&(null==(e=r.pointTarget)?void 0:e.iMod)==t.iMod?4:2},visible:function(){return!r.pointTarget||r.pointTarget.iMod==(null==t?void 0:t.iMod)||r.visible}}),t})}function savePosition(t,e,o,r){var n=e.create("point",[o.X(),o.Y()],{name:"",color:"black"}),o=t.pointTarget.iMod,o=(n.iMod=o,n.setAttribute({fixed:!0,visible:function(){return!t.pointTarget||t.pointTarget.iMod==(null==n?void 0:n.iMod)||t.visible},size:function(){var e;return t.pointTarget&&(null==(e=t.pointTarget)?void 0:e.iMod)==n.iMod?4:2}}),t.statusValidate=!1,n.typeCurve=r,n.typePoint="point",n&&t.positions.push(n),gDist(null==(o=t.positions)?void 0:o.at(-1),null==(r=t.positions)?void 0:r.at(-3)));null!=o&&o<.1&&(e.removeObject(t.positions.pop()),e.removeObject(t.positions.pop())),drawingRoad(t,e)}function drawingRoad(e,t){var o;e.roadDrawng&&t.removeObject(e.roadDrawng),e.pointTarget&&(e.roadDrawng=t.create("cardinalspline",[e.positions,0,"centripetal"],{layer:1e3,strokeColor:"red",strokeWidth:3}),(o=e.roadDrawng).iMod=e.pointTarget.iMod,o.setAttribute({visible:function(){return!e.pointTarget||e.pointTarget.iMod==(null==o?void 0:o.iMod)||e.visible},size:3}))}function addFinish(e){var t,o,r,n,i=e.def,l=e.board,e=e.def.positions;null!=i&&i.pointTarget&&null!=e&&null!=(i=e.at(-1))&&i.typePoint&&"finish"!=(null==(i=e.at(-1))?void 0:i.typePoint)&&(i=e[0],n=e.at(-1),r=null,1<e.length&&(r=e.at(-2)),gInterPoint(n.Y(),i.Y())||gInterPoint(r.X(),n.X(),.2)?o=n.Y():gInterPoint(r.X(),n.X(),.2)||(o=i.Y()),gInterPoint(n.X(),i.X())||gInterPoint(r.Y(),n.Y(),.05)?t=n.X():gInterPoint(r.Y(),n.Y(),.05)||(t=i.X()),r=e[0].visProp.fillcolor,gInterPoint(n.X(),t)&&gInterPoint(n.Y(),o)?(n.setAttribute({strokeColor:"green",fillcolor:r,size:4}),e.at(-1).typePoint="finish"):((n=l.create("point",[t,o],{strokeColor:"green",fillcolor:r,opacity:.8,size:4,fixed:!0,name:""})).iMod=i.iMod,n.typePoint="finish",e.push(n),e.length))}function roadMain(f,v){var y='<svg width="24px" height="24px" fill="none" strokeWidth="1.5" viewBox="0 0 24 24" color="#000000"><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"></path><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="M21 12c-1.889 2.991-5.282 6-9 6s-7.111-3.009-9-6c2.299-2.842 4.992-6 9-6s6.701 3.158 9 6Z"></path></svg>',b='<svg width="24px" height="24px" fill="none" strokeWidth="1.5" viewBox="0 0 24 24" color="#321322"><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="m3 3 18 18M10.5 10.677a2 2 0 0 0 2.823 2.823"></path><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="M7.362 7.561C5.68 8.74 4.279 10.42 3 12c1.889 2.991 5.282 6 9 6 1.55 0 3.043-.523 4.395-1.35M12 6c4.008 0 6.701 3.158 9 6a15.66 15.66 0 0 1-1.078 1.5"></path></svg>',g=["#f16413","violet","#4955FE","#ffa420","#083964","#0073e8","#31379a","#048E62","#6B1B9A","#195E20"],m=document.querySelector("#tmp-road");document.querySelectorAll(".defRoad").forEach(function(e,t){var o,r=m.content.firstElementChild.cloneNode(!0),n=r.querySelector(".defRoadBoard"),i=r.querySelector(".btn-all"),l="defRoadBoard_"+t,n=(n.setAttribute("id",l),r.querySelector(".rEnunciadoTop")),a=r.querySelector(".rEnunciadoBottom"),s=e.dataset.board||v[(null==(s=e.dataset)?void 0:s.artifact)||"artifact_0"].defBoard||"board_0",u=e.dataset.artifact||(null==(d=f[s||"board_0"])?void 0:d.artifact)||"artifact_0",c=(r.setAttribute("id",u),_objectSpread(_objectSpread({statusValidate:!0,lastDirection:null,timeInteraction:0,curvesDefaults:[],numberBoard:!1,targeIndexY:null,pointTarget:null,targeIndex:null,inBorder:!1,dataInteraction:{incorrect:0,correct:0,forAnswer:0},samePoints:[[]],textAlert:null,roadData:[],positionsX:[],positionsY:[],positions:[],visible:!0,debug:!1,points:[[]],memory:[],curves:[],other:[],globalColor:g},v[u]),{},{buttonsActive:_objectSpread({return:!0,points:!1},null==(d=v[u])?void 0:d.buttonsActive),conditions:{road:_objectSpread(_objectSpread({text:"Intenta de Nuevo",points:!1},null==(d=v[u])||null==(d=d.conditions)?void 0:d.road),{},{curve:_objectSpread({board:null,minFinishPoint:3,modNegative:null,confirmCurve:!1},null==(d=v[u])||null==(d=d.conditions)||null==(d=d.road)?void 0:d.curve)})},curvesDefaults:[],lastDirection:null,pointTarget:null,targeIndexY:null,targeIndex:null})),d=(c.enumTop?n.textContent=c.enumTop:n&&(n.parentNode.style.display="none"),c.enumBottom?a.textContent=c.enumBottom:a&&(a.parentNode.style.display="none"),f[s].style),n=(e.appendChild(r),f[s].style.reflectionAxie={Y:null==(a=null==(n=f[s])||null==(n=n.style)||null==(n=n.reflectionAxie)?void 0:n.Y)||a,X:null==(n=null==(e=f[s])||null==(e=e.style)||null==(e=e.reflectionAxie)?void 0:e.X)||n,B:null==(e=null==(a=f[s])||null==(a=a.style)||null==(a=a.reflectionAxie)?void 0:a.B)||e},gBoard(c,f[s],l,d,null,t,{globalColor:g,content:r})),p=n.board,a=p.attr.boundingbox,e=(c.numberBoard&&p.create("point",[a[1],a[3]],_defineProperty(_defineProperty({name:c.numberBoard,fixed:!0,label:{position:"rt",fixed:!0,offset:[-25,25],fontSize:18,strokeColor:"black",visible:!0}},"fixed",!0),"visible",!1)),gCurveDefault({board:p,curves:[{typeCurve:"border",flex:0,points:[[a[0],a[1]],[a[1],a[2]],[a[2],a[3]],[a[3],a[0]],[a[0],a[1]]],strokeColor:"red",strokeWidth:3,visible:!1}]}));c.curveGenerate=_toConsumableArray(n.resultObj.curves.map(function(e){return"finishCurve"==e.typeCurve&&e.setAttribute({visible:!1}),e})),n.resultObj.points&&((s=document.createElement("option")).innerHTML="&#9679",s.style.color="black",s.value=-1,o=[],c.pointsData=n.resultObj.points.map(function(t,e){return o.push({style:{color:g[e]}}),t.setAttribute({fixed:!0,visible:function(){var e;return!c.pointTarget||(null==c||null==(e=c.pointTarget)?void 0:e.iMod)==t.iMod||c.visible},color:g[e],size:function(){var e;return c.pointTarget&&(null==(e=c.pointTarget)?void 0:e.iMod)==t.iMod?4:2}}),t.typePoint="point",t.typeCurve="ejeX",t.iMod=e,c.roadData.push([]),t}),c.selectRoad=new CreateSelectsPoints(function(e){rSelectInteraction(c,p,e)},r.querySelector(".rInteractiveOne"),o,"before")),c.curvesDefaults=[].concat(_toConsumableArray(n.resultObj.curves),_toConsumableArray(Object.values(c.reflectionAxie)),_toConsumableArray(e)),i.addEventListener("click",function(e){e=e.target;e.matches(".rUp_arrow")?move(c,p,c.positionsY,"up"):e.matches(".rDown_arrow")?move(c,p,c.positionsY,"down"):e.matches(".rRight_arrow")?move(c,p,c.positionsX,"right"):e.matches(".rLeft_arrow")?move(c,p,c.positionsX,"left"):e.matches(".finishRoad")?finishPoint({board:p,def:c,clone:r}):e.matches(".visible, .visible svg")?(c.visible=!c.visible,c.visible?i.querySelector(".visible").innerHTML=y:i.querySelector(".visible").innerHTML=b):e.classList.contains("back")?rDefReturn(c,p,r):e.classList.contains("reset")?rDefReset(c,p,r):e.classList.contains("check")&&rDefValidation(c,f,r,u,p),p.update()}),v[u]=c})}function createLineIntersection(t,e){t.lineY&&(e.removeObject(t.lineX),e.removeObject(t.lineY)),t.lineY=e.create("line",[[function(){var e;return null==t||null==(e=t.pointer)?void 0:e.X()},5],[function(){var e;return null==t||null==(e=t.pointer)?void 0:e.X()},-5]],{anchorX:t.pointer,visible:!1}),t.lineX=e.create("line",[[5,function(){var e;return null==t||null==(e=t.pointer)?void 0:e.Y()}],[-5,function(){var e;return null==t||null==(e=t.pointer)?void 0:e.Y()}]],{anchorX:t.pointer,visible:!1})}function rDefReturn(e,t,o){var r,n;e.change=!0,e.statusValidate=!1,e.inBorder=!1,0<e.positions.length?(1===e.positions.length&&(e.positions.pop(),null!=e)&&e.pointTarget&&(e.pointTarget.setAttribute({size:2}),e.pointTarget=null,e.selectRoad.resetColor()),r=e.positions.pop(),(n=null==(n=e.positions.at(-1))||null==(n=n.coords)||null==(n=n.usrCoords)?void 0:n.slice(1))&&e.pointer.setPositionDirectly(JXG.COORDS_BY_USER,n),drawingRoad(e,t)):(r=e.memory.pop(),null!=e&&e.pointTarget&&(console.log("target2"),e.pointTarget.setAttribute({size:2,color:"red"}),e.pointTarget=null)),console.log("remove"),removeElemet(t,r),resetPointsBase(e,t,e.pointsData),e.textAlert&&(e.textAlert.remove(),e.textAlert=null)}function removeElemet(t,e){var o,r,n,i;"point"===(null==e||null==(r=e.from)||null==(r=r[0])||null==(r=r[0])?void 0:r.elType)&&(r=null==e||null==(r=e.from)||null==(r=r[0])?void 0:r[0].visProp.fillcolor,null!=e)&&null!=(o=e.from)&&null!=(o=o[0])&&null!=(o=o[0])&&o.setAttribute({color:r}),e&&(Array.isArray(e)&&0<e.length?e.forEach(function(e){removeElemet(t,e)}):(o=e.element,r=e.from,n=e.index,i=e.key,t.removeObject(null!=o?o:e),Array.isArray(r)?r.splice(n,1):null!=i&&(r[i]=null)))}function rDefReset(o,t){o.roadData=[],o.pointsData.forEach(function(e,t){e.setAttribute({color:o.globalColor[t],size:2}),o.roadData.push([])}),o.selectRoad.resetColor(),null!=o&&o.pointTarget&&(o.pointTarget.setAttribute({size:2}),o.pointTarget=null),o.curveGenerate.forEach(function(e){"finishCurve"==e.typeCurve&&e.setAttribute({visible:!1})}),0<o.positions.length&&(t.removeObject(o.positions.slice(1)),o.positions=[]),o.memory.forEach(function(e){removeElemet(t,e)}),o.memory=[],t.removeObject(o.samePoints),t.removeObject(o.points),t.removeObject(o.other.flat()),o.points=[[]],o.samePoints=[[]],o.curves=[],o.change=!1,o.textAlert&&(o.textAlert.remove(),o.textAlert=null),o.iMod2=[null,null]}function rDefValidation(o,e,t,r,n){var i;o.statusValidate?gAlerts({def:o,id:r,text:"Interactua",size:26,type:4}):(i=o.roadData.map(function(e,t){return 0==e.length&&(o.pointsData[t].setAttribute({strokeColor:"green",size:4}),e.push([o.pointsData[t]])),e.map(function(e){return Array.isArray(e)?e.map(function(e){return[e.X(),e.Y()]}):[e.X(),e.Y()]})}),rDefRoadValidation(o,e,i,o.conditions.road)?(o.dataInteraction.incorrect=0,o.dataInteraction.correct=1,gAlerts({def:o,id:r,text:"Excelente",size:26}),generateCurveFinish(o,n,e)):(o.dataInteraction.incorrect=1,o.dataInteraction.correct=0,gAlerts({def:o,id:r,text:o.conditions.road.text,size:26,type:2}),setTimeout(function(){o.textAlert&&(o.textAlert.remove(),o.textAlert=null)},1e3)),o.dataInteraction.forAnswer=0,"undefined"!=typeof Android&&"function"==typeof Android.sendData?Android.sendData(JSON.stringify(cleanData(o,r))):sendData(cleanData(o,r)),gTime(o,!1),o.change=!1,o.statusValidate=!0)}function discart(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return o[0]&&Array.isArray(o[0][0])?resp=o.some(function(e){return discart(e,r)}):Array.isArray(o)||"object"!=_typeof(o)?o.every(function(e,t){return gInterPoint(e[0],r[t][0],.2)&&gInterPoint(e[1],r[t][1],.2)&&r.length==o.length}):o.forks.every(function(t){return r.some(function(e){return discart(t,e)})})}function rDefRoadValidation(e,t,o,r,n){var i=null;if(!r.mod){for(var l=r.points.map(function(e){return e}),a=o.map(function(e){return e}),s=l.length-1;0<=s;s--)!function(t){var e=a.findIndex(function(e){return discart(l[t],e)});-1!=e&&(l.splice(t,1),a.splice(e,1))}(s);i=0==l.length&&0==a.length}return 0!=i&&(null===i||i)}function cleanData(e,t){var o={};return(o={results:e.dataInteraction,elementArtifact:{pointsData:[[]],samePoints:[[]],curves:[]}}).artifact=Number(t.split("_")[t.split("_").length-1]),"Evaluation"==e.typeArtifact?o.typeArtifact="Evaluation":o.typeArtifact="Standard",o.seconds=e.timeInteraction,e.yellow&&(o.typeArtifact="Yellow",delete o.results),console.log(o),o}function generateCurveFinish(r,n,e){var t;null!=(t=r.conditions.road)&&t.curveReflex?null!=(t=r.conditions.road)&&t.curveReflex.forEach(function(e){var t,o;e.curve?((t=r.curveGenerate[null==(t=e.curve)?void 0:t.index]).setAttribute({visible:!0}),r.curvefinish=t):(o=r.reflectionAxie[e.axie],r.curvefinish=[],e.index.forEach(function(e){r.curvefinish.push(n.create("reflection",[r.curveGenerate[e],o],{strokeWidth:2,strokeColor:"green"}))}),(t=r.other).push.apply(t,_toConsumableArray(r.curvefinish)))}):console.warn("<!>No se definio una curva para este ejercicio<!>")}function rSelectInteraction(e,t,o){o=Number(o);0<e.positions.length&&t.removeObject(e.positions.slice(1)),e.pointTarget&&e.pointTarget.setAttribute({size:2}),e.positions=[],null!=e&&e.pointer&&t.removeObject(null==e?void 0:e.pointer),e.pointsData[Number(o)]&&(e.pointTarget=e.pointsData[Number(o)],e.pointTarget.setAttribute({size:4}),e.pointTarget)&&(e.pointTarget.typePoint="point",e.pointTarget.typeCurve="ejeX",e.pointer=t.create("point",[e.pointTarget.X(),e.pointTarget.Y()],{name:"",size:4,fixed:!0,visible:!1,color:"red"}),e.pointer.typeCurve="ejeX",e.pointer.typePoint="point",e.positions.push(e.pointTarget))}function resetPointsBase(o,e,t){t.forEach(function(e,t){e.setAttribute({color:o.globalColor[t],size:2})}),e.update(),o.curveGenerate.forEach(function(e){"finishCurve"==e.typeCurve&&e.setAttribute({visible:!1})})}