function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r,o=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,r)),o}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}function getPositionAvailable(e,t,r){["up","down"].includes(r)?e.positionsY=intersection(e,t,e.curvesDefaults,e.lineY,2):e.positionsX=intersection(e,t,e.curvesDefaults,e.lineX)}function move(e,t,r,o){if(e.pointTarget&&e.pointer){createLineIntersection(e,t),getPositionAvailable(e,t,o);var n=e.positions.at(-2),i=["up","down"].includes(o)?e.positionsY:e.positionsX,l=["left","right"].includes(o)?e.targeIndex:e.targeIndexY,r=(e.inBorder&&["ejeX","ejeY"].includes(null==r||null==(r=r.at(-2))?void 0:r.typeCurve)&&(e.inBorder=!1),["up","right"].includes(o)?l++:l--,null==i?void 0:i[l]);if(null!=e&&e.inBorder||"border"!=(null==r?void 0:r.typeCurve)){if(-1==l||e.inBorder&&.1<gDist([r.x,r.y],n))return void console.log("return");e.inBorder=!1}else e.inBorder=!0;n=[r.x,r.y];e.pointer.setPositionDirectly(JXG.COORDS_BY_USER,n),savePosition(e,t,e.pointer,i[l].typeCurve),e.lastDirection=o}}function intersection(o,n,i,l){for(var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,s=[],u=0;u<i.length;u++)if(!i[u].useIntersection&&null!==i[u].useIntersection&&"finishCurve"!==i[u].typeCurve)for(var c=0;c<3;c++)!function(){var e;try{t=JXG.Math.Geometry.meetCurveLine(i[u],l,c,n,!0)}catch(e){}if(!t)return;var t,r=null==(e=t)||null==(e=e.usrCoords)?void 0:e.slice(1);Number.isNaN(null==(e=t)||null==(e=e.usrCoords)?void 0:e.slice(1)[0])||!(1!=a&&gInterPoint(o.pointer.X(),r[0])||1==a&&gInterPoint(o.pointer.Y(),r[1]))||!r[0]&&0!=r[0]||!r[1]&&0!=r[1]||s.some(function(e){return gDist(r,[e.x,e.y])<.01&&!(gDist(r,o.pointer)<.01)})||gDist(r,o.pointer)<.01||(t={x:r[0],y:r[1],typeCurve:i[u].typeCurve},s.push(t))}();var e=o.pointer.coords.usrCoords.slice(1);return s.push({x:e[0],y:e[1],id:o.pointer.id}),s.sort(function(e,t){return 1==a?e.x-t.x:e.y-t.y}),1==a?o.targeIndex=s.findIndex(function(e){return e.id===o.pointer.id}):o.targeIndexY=s.findIndex(function(e){return e.id===o.pointer.id}),s}function finishPoint(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,r=t.board,o=t.def,t=(t.clone.querySelector(".rSelectRoad"),o.positions[0].visProp.fillcolor);addFinish(e),o.statusValidate=!1,o.selectRoad.resetColor(),o.positions=cleanRoad({def:o,road:o.positions}),o.memory.push({element:_toConsumableArray(o.positions.slice(1)),from:o.roadData[o.positions[0].iMod]}),drawingRoad(o,r),o.roadData[o.positions[0].iMod].push(_toConsumableArray(o.positions)),o.other.push(o.roadDrawng),o.positions=[],o.roadDrawng.setAttribute({layer:null,strokeColor:t}),o.roadDrawng=null,o.pointTarget=null}function cleanRoad(e){var o=e.def,n=e.road;return n.filter(function(t,e){var r;return t.setAttribute({size:function(){var e;return o.pointTarget&&(null==(e=o.pointTarget)?void 0:e.iMod)==t.iMod?4:2},visible:!1}),0==e||e==n.length-1||!(gInterPoint(null==t?void 0:t.Y(),null==n||null==(r=n[e-1])?void 0:r.Y(),.01)&&!gInterPoint(null==t?void 0:t.X(),null==n||null==(r=n[e+1])?void 0:r.X(),.01)||!gInterPoint(null==t?void 0:t.Y(),null==n||null==(r=n[e-1])?void 0:r.Y(),.01)&&gInterPoint(null==t?void 0:t.X(),null==n||null==(r=n[e+1])?void 0:r.X(),.01))}).map(function(t){return t.setAttribute({size:function(){var e;return o.pointTarget&&(null==(e=o.pointTarget)?void 0:e.iMod)==t.iMod?4:2},visible:function(){return!o.pointTarget||o.pointTarget.iMod==(null==t?void 0:t.iMod)||o.visible}}),t})}function savePosition(t,e,r,o){var n=e.create("point",[r.X(),r.Y()],{name:"",color:"black"}),r=t.pointTarget.iMod,r=(n.iMod=r,n.setAttribute({fixed:!0,visible:function(){return!t.pointTarget||t.pointTarget.iMod==(null==n?void 0:n.iMod)||t.visible},size:function(){var e;return t.pointTarget&&(null==(e=t.pointTarget)?void 0:e.iMod)==n.iMod?4:2}}),t.statusValidate=!1,n.typeCurve=o,n.typePoint="point",n&&t.positions.push(n),gDist(null==(r=t.positions)?void 0:r.at(-1),null==(o=t.positions)?void 0:o.at(-3)));null!=r&&r<.1&&(e.removeObject(t.positions.pop()),e.removeObject(t.positions.pop())),drawingRoad(t,e)}function drawingRoad(e,t){var r;e.roadDrawng&&t.removeObject(e.roadDrawng),e.pointTarget&&(e.roadDrawng=t.create("cardinalspline",[e.positions,0,"centripetal"],{layer:1e3,strokeColor:"red",strokeWidth:3}),(r=e.roadDrawng).iMod=e.pointTarget.iMod,r.setAttribute({visible:function(){return!e.pointTarget||e.pointTarget.iMod==(null==r?void 0:r.iMod)||e.visible},size:3}))}function addFinish(e){var t,r,o,n,i=e.def,l=e.board,e=e.def.positions;null!=i&&i.pointTarget&&null!=e&&null!=(i=e.at(-1))&&i.typePoint&&"finish"!=(null==(i=e.at(-1))?void 0:i.typePoint)&&(i=e[0],n=e.at(-1),o=null,1<e.length&&(o=e.at(-2)),gInterPoint(n.Y(),i.Y())||gInterPoint(o.X(),n.X(),.2)?r=n.Y():gInterPoint(o.X(),n.X(),.2)||(r=i.Y()),gInterPoint(n.X(),i.X())||gInterPoint(o.Y(),n.Y(),.05)?t=n.X():gInterPoint(o.Y(),n.Y(),.05)||(t=i.X()),o=e[0].visProp.fillcolor,gInterPoint(n.X(),t)&&gInterPoint(n.Y(),r)?(n.setAttribute({strokeColor:"green",fillcolor:o,size:4}),e.at(-1).typePoint="finish"):((n=l.create("point",[t,r],{strokeColor:"green",fillcolor:o,opacity:.8,size:4,fixed:!0,name:""})).iMod=i.iMod,n.typePoint="finish",e.push(n),e.length))}function roadMain(f,v){var y='<svg width="24px" height="24px" fill="none" strokeWidth="1.5" viewBox="0 0 24 24" color="#000000"><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"></path><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="M21 12c-1.889 2.991-5.282 6-9 6s-7.111-3.009-9-6c2.299-2.842 4.992-6 9-6s6.701 3.158 9 6Z"></path></svg>',b='<svg width="24px" height="24px" fill="none" strokeWidth="1.5" viewBox="0 0 24 24" color="#321322"><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="m3 3 18 18M10.5 10.677a2 2 0 0 0 2.823 2.823"></path><path stroke="#000000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" d="M7.362 7.561C5.68 8.74 4.279 10.42 3 12c1.889 2.991 5.282 6 9 6 1.55 0 3.043-.523 4.395-1.35M12 6c4.008 0 6.701 3.158 9 6a15.66 15.66 0 0 1-1.078 1.5"></path></svg>',g=["#f16413","violet","#4955FE","#ffa420","#083964","#0073e8","#31379a","#048E62","#6B1B9A","#195E20"],m=document.querySelector("#tmp-road");document.querySelectorAll(".defRoad").forEach(function(e,t){var r,o=m.content.firstElementChild.cloneNode(!0),n=o.querySelector(".defRoadBoard"),i=o.querySelector(".btn-all"),l="defRoadBoard_"+t,n=(n.setAttribute("id",l),o.querySelector(".rEnunciadoTop")),a=o.querySelector(".rEnunciadoBottom"),s=e.dataset.board||v[(null==(s=e.dataset)?void 0:s.artifact)||"artifact_0"].defBoard||"board_0",u=e.dataset.artifact||(null==(d=f[s||"board_0"])?void 0:d.artifact)||"artifact_0",c=(o.setAttribute("id",u),_objectSpread(_objectSpread({statusValidate:!0,lastDirection:null,timeInteraction:0,curvesDefaults:[],numberBoard:!1,targeIndexY:null,pointTarget:null,targeIndex:null,inBorder:!1,dataInteraction:{incorrect:0,correct:0,forAnswer:0},samePoints:[[]],textAlert:null,roadData:[],positionsX:[],positionsY:[],positions:[],visible:!0,debug:!1,points:[[]],memory:[],curves:[],other:[],globalColor:g},v[u]),{},{buttonsActive:_objectSpread({return:!0,points:!1},null==(d=v[u])?void 0:d.buttonsActive),conditions:{road:_objectSpread(_objectSpread({text:"Intenta de Nuevo",points:!1},null==(d=v[u])||null==(d=d.conditions)?void 0:d.road),{},{curve:_objectSpread({board:null,minFinishPoint:3,modNegative:null,confirmCurve:!1},null==(d=v[u])||null==(d=d.conditions)||null==(d=d.road)?void 0:d.curve)})},curvesDefaults:[],lastDirection:null,pointTarget:null,targeIndexY:null,targeIndex:null})),d=(c.enumTop?n.textContent=c.enumTop:n&&(n.parentNode.style.display="none"),c.enumBottom?a.textContent=c.enumBottom:a&&(a.parentNode.style.display="none"),f[s].style),n=(e.appendChild(o),f[s].style.reflectionAxie={Y:null==(a=null==(n=f[s])||null==(n=n.style)||null==(n=n.reflectionAxie)?void 0:n.Y)||a,X:null==(n=null==(e=f[s])||null==(e=e.style)||null==(e=e.reflectionAxie)?void 0:e.X)||n,B:null==(e=null==(a=f[s])||null==(a=a.style)||null==(a=a.reflectionAxie)?void 0:a.B)||e},gBoard(c,f[s],l,d,null,t,{globalColor:g,content:o})),p=n.board,a=p.attr.boundingbox,e=(c.numberBoard&&p.create("point",[a[1],a[3]],_defineProperty(_defineProperty({name:c.numberBoard,fixed:!0,label:{position:"rt",fixed:!0,offset:[-25,25],fontSize:18,strokeColor:"black",visible:!0}},"fixed",!0),"visible",!1)),gCurveDefault({board:p,curves:[{typeCurve:"border",flex:0,points:[[a[0],a[1]],[a[1],a[2]],[a[2],a[3]],[a[3],a[0]],[a[0],a[1]]],strokeColor:"red",strokeWidth:3,visible:!1}]}));c.curveGenerate=_toConsumableArray(n.resultObj.curves.map(function(e){return"finishCurve"==e.typeCurve&&e.setAttribute({visible:!1}),e})),n.resultObj.points&&((s=document.createElement("option")).innerHTML="&#9679",s.style.color="black",s.value=-1,r=[],c.pointsData=n.resultObj.points.map(function(t,e){return r.push({style:{color:g[e]}}),t.setAttribute({fixed:!0,visible:function(){var e;return!c.pointTarget||(null==c||null==(e=c.pointTarget)?void 0:e.iMod)==t.iMod||c.visible},color:g[e],size:function(){var e;return c.pointTarget&&(null==(e=c.pointTarget)?void 0:e.iMod)==t.iMod?4:2}}),t.typePoint="point",t.typeCurve="ejeX",t.iMod=e,c.roadData.push([]),t}),c.selectRoad=new CreateSelectsPoints(function(e){rSelectInteraction(c,p,e)},o.querySelector(".rInteractiveOne"),r,"before")),c.curvesDefaults=[].concat(_toConsumableArray(n.resultObj.curves),_toConsumableArray(Object.values(c.reflectionAxie)),_toConsumableArray(e)),i.addEventListener("click",function(e){e=e.target;e.matches(".rUp_arrow")?move(c,p,c.positionsY,"up"):e.matches(".rDown_arrow")?move(c,p,c.positionsY,"down"):e.matches(".rRight_arrow")?move(c,p,c.positionsX,"right"):e.matches(".rLeft_arrow")?move(c,p,c.positionsX,"left"):e.matches(".finishRoad")?finishPoint({board:p,def:c,clone:o}):e.matches(".visible, .visible svg")?(c.visible=!c.visible,c.visible?i.querySelector(".visible").innerHTML=y:i.querySelector(".visible").innerHTML=b):e.classList.contains("back")?rDefReturn(c,p,o):e.classList.contains("reset")?rDefReset(c,p,o):e.classList.contains("check")&&rDefValidation(c,f,o,u,p),p.update()}),v[u]=c})}function createLineIntersection(t,e){t.lineY&&(e.removeObject(t.lineX),e.removeObject(t.lineY)),t.lineY=e.create("line",[[function(){var e;return null==t||null==(e=t.pointer)?void 0:e.X()},5],[function(){var e;return null==t||null==(e=t.pointer)?void 0:e.X()},-5]],{anchorX:t.pointer,visible:!1}),t.lineX=e.create("line",[[5,function(){var e;return null==t||null==(e=t.pointer)?void 0:e.Y()}],[-5,function(){var e;return null==t||null==(e=t.pointer)?void 0:e.Y()}]],{anchorX:t.pointer,visible:!1})}function rDefReturn(e,t,r){var o,n;e.change=!0,e.statusValidate=!1,e.inBorder=!1,0<e.positions.length?(1===e.positions.length&&(e.positions.pop(),null!=e)&&e.pointTarget&&(e.pointTarget.setAttribute({size:2}),e.pointTarget=null,e.selectRoad.resetColor()),o=e.positions.pop(),(n=null==(n=e.positions.at(-1))||null==(n=n.coords)||null==(n=n.usrCoords)?void 0:n.slice(1))&&e.pointer.setPositionDirectly(JXG.COORDS_BY_USER,n),drawingRoad(e,t)):(o=e.memory.pop(),null!=e&&e.pointTarget&&(console.log("target2"),e.pointTarget.setAttribute({size:2,color:"red"}),e.pointTarget=null)),console.log("remove"),removeElemet(t,o),resetPointsBase(e,t,e.pointsData),e.textAlert&&(e.textAlert.remove(),e.textAlert=null)}function removeElemet(t,e){var r,o,n,i;"point"===(null==e||null==(o=e.from)||null==(o=o[0])||null==(o=o[0])?void 0:o.elType)&&(o=null==e||null==(o=e.from)||null==(o=o[0])?void 0:o[0].visProp.fillcolor,null!=e)&&null!=(r=e.from)&&null!=(r=r[0])&&null!=(r=r[0])&&r.setAttribute({color:o}),e&&(Array.isArray(e)&&0<e.length?e.forEach(function(e){removeElemet(t,e)}):(r=e.element,o=e.from,n=e.index,i=e.key,t.removeObject(null!=r?r:e),Array.isArray(o)?o.splice(n,1):null!=i&&(o[i]=null)))}function rDefReset(r,t){r.roadData=[],r.pointsData.forEach(function(e,t){e.setAttribute({color:r.globalColor[t],size:2}),r.roadData.push([])}),r.selectRoad.resetColor(),null!=r&&r.pointTarget&&(r.pointTarget.setAttribute({size:2}),r.pointTarget=null),r.curveGenerate.forEach(function(e){"finishCurve"==e.typeCurve&&e.setAttribute({visible:!1})}),0<r.positions.length&&(t.removeObject(r.positions.slice(1)),r.positions=[]),r.memory.forEach(function(e){removeElemet(t,e)}),r.memory=[],t.removeObject(r.samePoints),t.removeObject(r.points),t.removeObject(r.other.flat()),r.points=[[]],r.samePoints=[[]],r.curves=[],r.change=!1,r.textAlert&&(r.textAlert.remove(),r.textAlert=null),r.iMod2=[null,null]}function rDefValidation(r,e,t,o,n){var i;r.statusValidate?gAlerts({def:r,id:o,text:"Interactua",size:26,type:4}):(i=r.roadData.map(function(e,t){return 0==e.length&&(r.pointsData[t].setAttribute({strokeColor:"green",size:4}),e.push([r.pointsData[t]])),e.map(function(e){return Array.isArray(e)?e.map(function(e){return[e.X(),e.Y()]}):[e.X(),e.Y()]})}),rDefRoadValidation(r,e,i,r.conditions.road)?(r.dataInteraction.incorrect=0,r.dataInteraction.correct=1,gAlerts({def:r,id:o,text:"Excelente",size:26}),generateCurveFinish(r,n,e)):(r.dataInteraction.incorrect=1,r.dataInteraction.correct=0,gAlerts({def:r,id:o,text:r.conditions.road.text,size:26,type:2}),setTimeout(function(){r.textAlert&&(r.textAlert.remove(),r.textAlert=null)},1e3)),r.dataInteraction.forAnswer=0,"undefined"!=typeof Android&&"function"==typeof Android.sendData?Android.sendData(JSON.stringify(cleanData(r,o))):sendData(cleanData(r,o)),gTime(r,!1),r.change=!1,r.statusValidate=!0)}function discart(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return r[0]&&Array.isArray(r[0][0])?resp=r.some(function(e){return discart(e,o)}):Array.isArray(r)||"object"!=_typeof(r)?r.every(function(e,t){return gInterPoint(e[0],o[t][0],.2)&&gInterPoint(e[1],o[t][1],.2)&&o.length==r.length}):r.forks.every(function(t){return o.some(function(e){return discart(t,e)})})}function rDefRoadValidation(e,t,r,o,n){var i=null;if(!o.mod){for(var l=o.points.map(function(e){return e}),a=r.map(function(e){return e}),s=l.length-1;0<=s;s--)!function(t){var e=a.findIndex(function(e){return discart(l[t],e)});-1!=e&&(l.splice(t,1),a.splice(e,1))}(s);i=0==l.length&&0==a.length}return 0!=i&&(null===i||i)}function cleanData(e,t){var r={};return(r={results:e.dataInteraction,elementArtifact:{pointsData:[[]],samePoints:[[]],curves:[]}}).artifact=Number(t.split("_")[t.split("_").length-1]),r.typeArtifact="Standard",r.seconds=e.timeInteraction,e.yellow&&(r.typeArtifact="Yellow",delete r.results),r}function generateCurveFinish(o,n,e){var t;null!=(t=o.conditions.road)&&t.curveReflex?null!=(t=o.conditions.road)&&t.curveReflex.forEach(function(e){var t,r;e.curve?((t=o.curveGenerate[null==(t=e.curve)?void 0:t.index]).setAttribute({visible:!0}),o.curvefinish=t):(r=o.reflectionAxie[e.axie],o.curvefinish=[],e.index.forEach(function(e){o.curvefinish.push(n.create("reflection",[o.curveGenerate[e],r],{strokeWidth:2,strokeColor:"green"}))}),(t=o.other).push.apply(t,_toConsumableArray(o.curvefinish)))}):console.warn("<!>No se definio una curva para este ejercicio<!>")}function rSelectInteraction(e,t,r){r=Number(r);0<e.positions.length&&t.removeObject(e.positions.slice(1)),e.pointTarget&&e.pointTarget.setAttribute({size:2}),e.positions=[],null!=e&&e.pointer&&t.removeObject(null==e?void 0:e.pointer),e.pointsData[Number(r)]&&(e.pointTarget=e.pointsData[Number(r)],e.pointTarget.setAttribute({size:4}),e.pointTarget)&&(e.pointTarget.typePoint="point",e.pointTarget.typeCurve="ejeX",e.pointer=t.create("point",[e.pointTarget.X(),e.pointTarget.Y()],{name:"",size:4,fixed:!0,visible:!1,color:"red"}),e.pointer.typeCurve="ejeX",e.pointer.typePoint="point",e.positions.push(e.pointTarget))}function resetPointsBase(r,e,t){t.forEach(function(e,t){e.setAttribute({color:r.globalColor[t],size:2})}),e.update(),r.curveGenerate.forEach(function(e){"finishCurve"==e.typeCurve&&e.setAttribute({visible:!1})})}